from datetime import datetime
import jdatetime
import pytz

# Iran timezone
IRAN_TZ = pytz.timezone('Asia/Tehran')

# Font mappings for time display
FONTS = {
    0: {'name': 'Normal', 'example': '12:34:56'},
    1: {'name': 'Subscript', 'example': '₁₂:₃₄:₅₆'},
    2: {'name': 'Superscript', 'example': '¹²:³⁴:⁵⁶'},
    3: {'name': 'Fullwidth', 'example': '１２:３４:５６'},
    4: {'name': 'Mathematical Bold', 'example': '𝟏𝟐:𝟑𝟒:𝟓𝟔'},
    5: {'name': 'Mathematical Double-struck', 'example': '𝟙𝟚:𝟛𝟜:𝟝𝟞'},
}

CHAR_MAP = {
    0: {'0': '0', '1': '1', '2': '2', '3': '3', '4': '4', '5': '5', '6': '6', '7': '7', '8': '8', '9': '9', ':': ':'},
    1: {'0': '₀', '1': '₁', '2': '₂', '3': '₃', '4': '₄', '5': '₅', '6': '₆', '7': '₇', '8': '₈', '9': '₉', ':': ':'},
    2: {'0': '⁰', '1': '¹', '2': '²', '3': '³', '4': '⁴', '5': '⁵', '6': '⁶', '7': '⁷', '8': '⁸', '9': '⁹', ':': ':'},
    3: {'0': '０', '1': '１', '2': '２', '3': '３', '4': '４', '5': '５', '6': '６', '7': '７', '8': '８', '9': '９', ':': '：'},
    4: {'0': '𝟎', '1': '𝟏', '2': '𝟐', '3': '𝟑', '4': '𝟒', '5': '𝟓', '6': '𝟔', '7': '𝟕', '8': '𝟖', '9': '𝟗', ':': ':'},
    5: {'0': '𝟘', '1': '𝟙', '2': '𝟚', '3': '𝟛', '4': '𝟜', '5': '𝟝', '6': '𝟞', '7': '𝟟', '8': '𝟠', '9': '𝟡', ':': ':'},
}


def get_iran_now():
    """Get current time in Iran timezone"""
    return datetime.now(IRAN_TZ)


def format_iran_time(dt=None, font_id=0):
    """Format time with selected font style"""
    if dt is None:
        dt = get_iran_now()
    
    time_str = dt.strftime('%H:%M:%S')
    
    if font_id in CHAR_MAP:
        char_mapping = CHAR_MAP[font_id]
        return ''.join(char_mapping.get(c, c) for c in time_str)
    
    return time_str


def get_jalali_date(dt=None):
    """Get Jalali calendar date"""
    if dt is None:
        dt = get_iran_now()
    
    j_date = jdatetime.datetime.fromgregorian(datetime=dt)
    return j_date.strftime('%Y/%m/%d')


def get_gregorian_date(dt=None):
    """Get Gregorian calendar date"""
    if dt is None:
        dt = get_iran_now()
    
    return dt.strftime('%Y/%m/%d')


def format_date(date_type='jalali', dt=None, font_id=0):
    """Format date with selected font and calendar type"""
    if date_type == 'jalali':
        date_str = get_jalali_date(dt)
    else:
        date_str = get_gregorian_date(dt)
    
    if font_id in CHAR_MAP:
        char_mapping = CHAR_MAP[font_id]
        return ''.join(char_mapping.get(c, c) for c in date_str)
    
    return date_str


# Text formatting options
TEXT_FORMATS = {
    'bold': {'name': '🔹 بولد', 'emoji': '🔹'},
    'italic': {'name': '🔸 ایتالیک', 'emoji': '🔸'},
    'underline': {'name': '🔹 زیرخط', 'emoji': '🔹'},
    'strikethrough': {'name': '🔸 خط خورده', 'emoji': '🔸'},
    'monospace': {'name': '🔹 کد', 'emoji': '🔹'},
    'spoiler': {'name': '🔸 اسپویلر', 'emoji': '🔸'},
    'mention': {'name': '🔹 منشن', 'emoji': '🔹'},
    'quote': {'name': '🔸 نقل و قول', 'emoji': '🔸'},
    'hashtag': {'name': '🔸 هشتگ', 'emoji': '🔸'},
    'reverse': {'name': '🔹 معکوس', 'emoji': '🔹'},
    'progressive': {'name': '🔸 تدریجی', 'emoji': '🔸'},
}

# Media lock options
MEDIA_LOCKS = {
    'gif': '🔒 قفل گیف',
    'photo': '🔒 قفل عکس',
    'video': '🔒 قفل ویدیو',
    'voice': '🔒 قفل ویس',
    'sticker': '🔒 قفل استیکر',
    'document': '🔒 قفل فایل',
    'audio': '🔒 قفل موزیک',
    'video_note': '🔒 قفل ویدیو نوت',
    'contact': '🔒 قفل کانتکت',
    'location': '🔒 قفل لوکیشن',
    'emoji': '🔒 قفل ایموجی',
    'text': '🔒 قفل متن',
}

# Status and action options
STATUS_ACTIONS = {
    'typing': '🎮 تایپ',
    'playing': '🎯 بازی',
    'recording_voice': '🎙 ضبط ویس',
    'uploading_photo': '📸 عکس',
    'uploading_video': '🎬 گیف',
    'choosing_contact': '👁 سین',
}

# Translation languages
TRANSLATION_LANGS = {
    'english': '🇬🇧 انگلیسی',
    'chinese': '🇨🇳 چینی',
    'russian': '🇷🇺 روسی',
    'arabic': '🇸🇦 عربی',
    'spanish': '🇪🇸 اسپانیایی',
}


def apply_text_format(text, format_type):
    """Apply text formatting"""
    format_type = format_type.lower()
    
    if format_type == 'bold':
        return f'**{text}**'
    elif format_type == 'italic':
        return f'__{text}__'
    elif format_type == 'underline':
        return f'__<u>{text}</u>__'
    elif format_type == 'strikethrough':
        return f'~~{text}~~'
    elif format_type == 'monospace':
        return f'`{text}`'
    elif format_type == 'code_block':
        return f'```\n{text}\n```'
    elif format_type == 'spoiler':
        return f'||{text}||'
    elif format_type == 'reverse':
        return text[::-1]
    elif format_type == 'progressive':
        # Animated progressive reveal
        lines = text.split('\n')
        return '\n'.join(['▬' * (len(line) // 2) + line[len(line)//2:] for line in lines])
    
    return text


def reverse_text(text):
    """Reverse text"""
    return text[::-1]


def get_all_features_menu():
    """Get main menu with all features in Persian"""
    return """╔═══════════════════════════════════╗
║   🌟 DRAGON SELF BOT 🌟   ║
║  ربات خودکار تلگرام با قابلیت‌های پیشرفته  ║
╚═══════════════════════════════════╝

┏━━━━━━━━━ ⚡ وضعیت و اکشن ⚡ ━━━━━━━━━┓
┃ 🎮 تایپ روشن/خاموش ➜ نمایش درحال تایپ
┃ 🎯 بازی روشن/خاموش ➜ نمایش درحال بازی
┃ 🎙 ضبط ویس روشن/خاموش ➜ ضبط صدا
┃ 📸 عکس روشن/خاموش ➜ آپلود عکس
┃ 🎬 گیف روشن/خاموش ➜ دیدن انیمیشن
┃ 👁 سین روشن/خاموش ➜ خواندن خودکار
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛

┏━━━━━━━━━ ✨ قالب‌بندی متن ✨ ━━━━━━━━━┓
┃ 🔹 بولد روشن/خاموش ➜ متن بولد
┃ 🔸 ایتالیک روشن/خاموش ➜ متن ایتالیک
┃ 🔹 زیرخط روشن/خاموش ➜ زیرخط‌دار
┃ 🔸 خط خورده روشن/خاموش ➜ خط‌خورده
┃ 🔹 کد روشن/خاموش ➜ فرمت کد
┃ 🔸 اسپویلر روشن/خاموش ➜ اسپویلر
┃ 🔹 منشن روشن/خاموش ➜ منشن (نیاز به ریپلای)
┃ 🔸 نقل و قول روشن/خاموش ➜ اگر ریپلای کنی: نقل‌قول خود تلگرام | اگر نه: ❝ متن ❞
┃ 🔸 هشتگ روشن/خاموش ➜ هشتگ
┃ 🔹 معکوس روشن/خاموش ➜ متن معکوس
┃ 🔸 تدریجی روشن/خاموش ➜ نمایش تدریجی
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛

┏━━━━━━━━━ 🌍 ترجمه خودکار 🌍 ━━━━━━━━━┓
┃ 🔄 ترجمه (ریپلای) ➜ ترجمه به فارسی
┃ 🇬🇧 انگلیسی روشن/خاموش ➜ ترجمه انگلیسی
┃ 🇨🇳 چینی روشن/خاموش ➜ ترجمه چینی
┃ 🇷🇺 روسی روشن/خاموش ➜ ترجمه روسی
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛

┏━━━━━━━━━ 🔒 قفل مدیا در PV 🔒 ━━━━━━━━━┓
┃ قفل گیف روشن/خاموش ➜ حذف گیف در PV
┃ قفل عکس روشن/خاموش ➜ حذف عکس در PV
┃ قفل ویدیو روشن/خاموش ➜ حذف ویدیو در PV
┃ قفل ویس روشن/خاموش ➜ حذف ویس در PV
┃ قفل استیکر روشن/خاموش ➜ حذف استیکر در PV
┃ قفل فایل روشن/خاموش ➜ حذف فایل در PV
┃ قفل موزیک روشن/خاموش ➜ حذف موزیک در PV
┃ قفل ویدیو نوت روشن/خاموش ➜ حذف ویدیو نوت در PV
┃ قفل کانتکت روشن/خاموش ➜ حذف کانتکت در PV
┃ قفل لوکیشن روشن/خاموش ➜ حذف لوکیشن در PV
┃ قفل ایموجی روشن/خاموش ➜ حذف پیام‌های دارای ایموجی در PV
┃ قفل متن روشن/خاموش ➜ حذف پیام‌های متنی در PV
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛

┏━━━━━━━━━ 🕐 ساعت و فونت 🕐 ━━━━━━━━━┓
┃ ⏰ ساعت روشن/خاموش ➜ ساعت در نام
┃ 🎨 فونت ➜ نمایش همه فونت‌ها
┃ 🖌 فونت [عدد] ➜ انتخاب فونت
┃ 📝 ساعت بیو روشن/خاموش ➜ ساعت در بیو
┃ 📅 تاریخ بیو روشن/خاموش ➜ تاریخ در بیو
┃ 🗓 نوع تاریخ میلادی/شمسی ➜ تغییر نوع
┃ ✏ فونت ساعت بیو ➜ فونت‌های بیو
┃ 🎭 فونت ساعت بیو [عدد] ➜ انتخاب فونت بیو
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛

┏━━━━━━━━━ 💬 مدیریت پیام 💬 ━━━━━━━━━┓
┃ 🗑 حذف [عدد] ➜ حذف پیام‌ها
┃ 🧹 حذف همه ➜ حذف تمام پیام‌ها
┃ 💾 ذخیره روشن/خاموش ➜ ذخیره تایم‌دار
┃ 🔒 ذخیره مخفی روشن/خاموش ➜ ذخیره با ریکشن
┃ 🔁 تکرار [عدد] [ثانیه] ➜ تکرار پیام
┃ 🔄 تکرار خودکار [ثانیه] ➜ تکرار مداوم
┃ ⏹ تکرار خودکار خاموش ➜ توقف تکرار
┃ 🚫 بلاک روشن/خاموش ➜ بلاک کاربر
┃ 🔇 سکوت روشن/خاموش ➜ میوت کاربر
┃ 😊 ریاکشن [ایموجی] ➜ ریاکشن خودکار
┃ ❌ ریاکشن خاموش ➜ خاموش کردن
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛

┏━━━━━━━━━ 💀 لیست دشمن 💀 ━━━━━━━━━┓
┃ ⚔ دشمن روشن/خاموش ➜ فعال/غیرفعال
┃ ➕ تنظیم دشمن (ریپلای) ➜ افزودن
┃ ➖ حذف دشمن (ریپلای) ➜ حذف
┃ 🧹 پاکسازی لیست دشمن ➜ پاک کردن
┃ 📋 لیست دشمن ➜ نمایش لیست
┃ 📝 تنظیم متن دشمن [متن] ➜ تنظیم پاسخ
┃ 📜 لیست متن دشمن ➜ نمایش پاسخ‌ها
┃ 🗑 حذف متن دشمن [عدد] ➜ حذف پاسخ
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛

┏━━━━━━━━━ 💚 لیست دوست 💚 ━━━━━━━━━┓
┃ 🤝 دوست روشن/خاموش ➜ فعال/غیرفعال
┃ ➕ تنظیم دوست (ریپلای) ➜ افزودن
┃ ➖ حذف دوست (ریپلای) ➜ حذف
┃ 🧹 پاکسازی لیست دوست ➜ پاک کردن
┃ 📋 لیست دوست ➜ نمایش لیست
┃ 📝 تنظیم متن دوست [متن] ➜ تنظیم پاسخ
┃ 📜 لیست متن دوست ➜ نمایش پاسخ‌ها
┃ 🗑 حذف متن دوست [عدد] ➜ حذف پاسخ
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛

┏━━━━━━━━━ 💕 کراش 💕 ━━━━━━━━━┓
┃ 💖 افزودن کراش (ریپلای) ➜ افزودن
┃ 💔 حذف کراش (ریپلای) ➜ حذف
┃ 📋 لیست کراش ➜ نمایش لیست
┃ 💌 تنظیم متن کراش [متن] ➜ تنظیم پیام
┃ 📜 لیست متن کراش ➜ نمایش پیام‌ها
┃ 🗑 حذف متن کراش [عدد] ➜ حذف پیام
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛

┏━━━━━━━━━ 💬 کامنت 💬 ━━━━━━━━━┓
┃ 💬 کامنت روشن/خاموش ➜ فعال/غیرفعال
┃ ✍ متن کامنت [متن] ➜ تنظیم متن کامنت
┃ ℹ️ کامنت روی پیام‌های forward شده ارسال می‌شود
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛

┏━━━━━━━━━ 🎉 سرگرمی 🎉 ━━━━━━━━━┓
┃ 💖 قلب / heart ➜ انیمیشن قلب
┃ 🎭 فان love / fun love ➜ انیمیشن قلب‌ها
┃ 🕐 فان oclock / fun oclock ➜ انیمیشن ساعت
┃ ⭐ فان star / fun star ➜ انیمیشن ستاره
┃ ❄ فان snow / fun snow ➜ انیمیشن برف
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛

┏━━━━━━━━━ 🛡 امنیت و منشی 🛡 ━━━━━━━━━┓
┃ 🔐 پیوی قفل ➜ قفل پیام‌های خصوصی
┃ 🔓 پیوی باز ➜ باز کردن پیام‌ها
┃ 📢 منشی روشن/خاموش ➜ فعال/غیرفعال
┃ 📝 منشی متن [متن] ➜ تنظیم پیام
┃ 🤖 منشی خودکار روشن/خاموش ➜ منشی AI
┃ 🔒 انتی لوگین روشن/خاموش ➜ محافظت ورود
┃ 👤 کپی روشن/خاموش ➜ کپی پروفایل
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛

┏━━━━━━━━━ 🧠 هوش مصنوعی و یادگیری 🧠 ━━━━━━━━━┓
┃ 🤖 تست ai ➜ تست عملکرد AI
┃ 📊 وضعیت یادگیری ➜ نمایش آمار
┃ 💾 بکاپ یادگیری ➜ دریافت بکاپ
┃ 🗑 پاکسازی یادگیری ➜ حذف داده‌ها
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛

┏━━━━━━━━━ 🛠 ابزار و مدیریت 🛠 ━━━━━━━━━┓
┃ 🏷 تگ / tagall ➜ تگ تمام اعضا
┃ 👑 تگ ادمین ها / tagadmins ➜ تگ ادمین‌ها
┃ 📱 شماره من ➜ نمایش شماره
┃ ⬇ دانلود (ریپلای) ➜ دانلود فایل
┃ 🚫 بن (ریپلای) ➜ بن کاربر
┃ 📌 پین (ریپلای) ➜ پین پیام
┃ 📍 آن پین ➜ آن‌پین کردن
┃ 📤 اسپم [متن] [تعداد] ➜ ارسال تکراری
┃ 🌊 فلود [متن] [تعداد] ➜ فلود سریع
┃ 📡 ping ➜ بررسی سرعت
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛

╔═══════════════════════════════════╗
║      💫 ساخته شده با عشق 💫      ║
║    برای استفاده بهتر از تلگرام    ║
╚═══════════════════════════════════╝"""
